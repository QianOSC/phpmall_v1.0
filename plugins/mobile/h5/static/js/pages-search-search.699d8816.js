(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-search-search"],{"650b":function(t,e,i){"use strict";i.r(e);var o=i("db77"),s=i("e143f");for(var a in s)"default"!==a&&function(t){i.d(e,t,function(){return s[t]})}(a);i("84a3");var n=i("2877"),r=Object(n["a"])(s["default"],o["a"],o["b"],!1,null,"1e26ebaf",null);e["default"]=r.exports},"84a3":function(t,e,i){"use strict";var o=i("8838"),s=i.n(o);s.a},8838:function(t,e,i){var o=i("e750");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var s=i("4f06").default;s("f8a29d84",o,!0,{sourceMap:!1,shadowMode:!1})},bc2e:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(i("a34a")),s=i("2f62"),a=r(i("24ba")),n=r(i("d3c4"));function r(t){return t&&t.__esModule?t:{default:t}}function c(t){return h(t)||l(t)||d()}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function l(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function h(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function u(t,e,i,o,s,a,n){try{var r=t[a](n),c=r.value}catch(d){return void i(d)}r.done?e(c):Promise.resolve(c).then(o,s)}function f(t){return function(){var e=this,i=arguments;return new Promise(function(o,s){var a=t.apply(e,i);function n(t){u(a,o,s,n,r,"next",t)}function r(t){u(a,o,s,n,r,"throw",t)}n(void 0)})}}function g(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,o)}return i}function v(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?g(i,!0).forEach(function(e){p(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):g(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var b=1,m=!1,w=!1,y={name:"search",components:{uOrdinaryList:a.default,uAttr:n.default},data:function(){return{hotGoodsList:[],list:[],isSearch:!1,historyList:[],keyword:"",recommend_list:[],mch_id:0,beginAfter:!0,tempList:[],realHistoryList:[],loading:!1,goodsReset:!1,attrGoods:{attrShow:0,goods:null},submitUrl:"",previewUrl:"",sign:"",url:""}},computed:v({},(0,s.mapGetters)("mallConfig",{getSetting:"getSetting"}),{newList:function(){return this.list.length>0?this.list:this.recommend_list},sizeTransform:function(){var t=uni.getSystemInfoSync().windowWidth,e=750/t,i=24/e,o=20/e,s=60/e,a=t-2*i;return{p:e,boxLeft:i,marginRight:o,btnWidth:s,listWidth:a}}},(0,s.mapState)({isListUnderlinePrice:function(t){return t.mallConfig.mall.setting.is_list_underline_price},themeObject:function(t){var e=t.mallConfig.mall.setting.theme_color;return{back:e+"-m-back "+e,backP:e+"-m-back-p "+e,backO:e+"-m-back-o "+e,theme:e,color:e+"-m-text "+e,sBack:e+"-s-back "+e,border:e+"-m-border "+e,mBtn:e+"-m-gradient-btn "+e,sBtn:e+"-s-gradient-btn "+e}}})),onLoad:function(t){this.mch_id=t.mch_id?t.mch_id:0,this.sign=t.sign?t.sign:"goods","goods"===this.sign?this.url=this.$api.default.goods_list:"pt"===this.sign?this.url=this.$api.pt.goods:"wholesale"===this.sign&&(this.url=this.$api.wholesale.index),b=1,m=!1,w=!1,this.historyList=this.getHistory(),this.getSelect(),this.getRecommend(),this.getHotSearch()},onReachBottom:function(){w||(this.goodsReset=!1,this.keyword&&(this.loading=!0,this.getGoodsList()))},watch:{keyword:{handler:function(t){""==t&&this.cancel()},immediate:!0}},methods:{getSelect:function(){var t=f(o.default.mark(function t(){var e,i,s;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=this.historyList,e&&e.length&&(i=this,s=0,setTimeout(function(){var t=uni.createSelectorQuery();t.selectAll(".once-item").fields({size:!0},function(t){i.formatData(t),i.beginAfter?i.selectLimitList(t):i.selectAllList()}).exec()},s));case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),formatData:function(t){for(var e=this,i=e.historyList,o=e.sizeTransform,s=o.marginRight,a=o.listWidth,n=[],r=[],c=0,d=0;d<t.length;d++){var l=t[d].width+s,h=l+c;h<=a?(r.push(i[d]),c=h):0===r.length&&0===c?n.push([i[d]]):(n.push(r),c=0,r=[],d--)}r.length&&n.push(r),this.tempList=n},selectLimitList:function(t){var e=this,i=e.sizeTransform,o=i.btnWidth,s=i.listWidth,a=i.marginRight,n=JSON.parse(JSON.stringify(e.tempList)),r=[];if(n.length>2){var c=0,d=s-o-a,l=0;n[1].forEach(function(e,i){l+=t[n[0].length+i].width+a,l<=d&&(c=i+1)}),n[1].splice(c,n[1].length-c,{mark:!0}),r=[n[0],n[1]],e.beginAfter=!0}else n.forEach(function(t){return r.push(t)}),e.beginAfter=!1;e.realHistoryList=r},selectAllList:function(){var t=this.tempList,e=[];if(t&&t.length)for(var i=0;i<5&&i<t.length;i++)e.push(t[i]);this.beginAfter=!1,this.realHistoryList=e},goodsNav:function(t){uni.navigateTo({url:t})},clear:function(){uni.hideKeyboard(),this.keyword="",this.loading=!1},getHotSearch:function(){var t=this;1==this.getSetting.is_show_hot_goods&&this.$request({url:this.$api.goods.hot_search}).then(function(e){t.hotGoodsList=e.data.list})},cancel:function(){this.isSearch=!1,this.loading=!1,this.keyword="",this.list=[]},reset:function(){b=1,w=!1,this.goodsReset=!0,this.getGoodsList()},search:function(){var t=this.keyword;""!==t&&(this.keyword=t.trim(),this.setHistory(),this.getSelect(),this.reset())},getGoodsList:function(){var t=this;this.keyword&&(m||(m=!0,this.$request({url:this.url,data:{keyword:this.keyword,mch_id:this.mch_id,page:b}}).then(function(e){m=!1,t.isSearch=!0,t.loading=!1;var i,o=e.code,s=e.data,a=e.msg;0===o?(1===b&&(t.list=[]),s.list.length>0?((i=t.list).push.apply(i,c(s.list)),b++):(w=!0,1===b&&t.getRecommend())):uni.showModal({content:a})}).catch(function(){m=!1})))},setHistory:function(){var t=this.getHistory(),e=this.keyword.trim();t.forEach(function(i,o){i.keyword===e&&t.splice(o,1)}),t.unshift({keyword:e}),t.length>20&&t.pop(),this.historyList=t,uni.setStorageSync("SEARCH_HISTORY_LIST",t)},getHistory:function(){var t=uni.getStorageSync("SEARCH_HISTORY_LIST");return t||(t=[]),t},deleteHistory:function(){var t=this;uni.showModal({content:"确认删除全部历史记录？",success:function(e){e.confirm&&(uni.removeStorageSync("SEARCH_HISTORY_LIST"),t.historyList=[])}})},historyClick:function(t){this.keyword=t.trim(),this.reset()},getRecommend:function(){var t=this;this.mch_id||this.recommend_list.length>0||this.$request({url:this.$api.goods.new_recommend,data:{goods_id:0,type:"goods"}}).then(function(e){0===e.code&&(t.recommend_list=e.data.list)})},buyProduct:function(t){var e=this,i=t.goods,o=t.attrShow;this.attrGoods.goods=i,setTimeout(function(){e.attrGoods.attrShow=o})}}};e.default=y},db77:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"app-layout",style:{background:t.isSearch?"#f7f7f7":"#fafafa"}},[i("app-layout",[i("v-uni-view",{staticClass:"search"},[i("v-uni-view",{staticClass:"top"},[i("v-uni-view",{staticClass:"dir-left-nowrap box"},[i("v-uni-input",{staticClass:"box-grow-1 input",attrs:{type:"text","confirm-type":"搜索"},on:{confirm:function(e){e=t.$handleEvent(e),t.search(e)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),i("v-uni-view",{staticClass:"close-tip",on:{click:function(e){e=t.$handleEvent(e),t.clear(e)}}},[t.keyword?i("v-uni-image",{staticClass:"search-close",attrs:{src:"/static/image/icon/delete-yuan.png"}}):t._e()],1),i("v-uni-view",{staticClass:"box-grow-0 cross-center",on:{click:function(e){e=t.$handleEvent(e),t.search(e)}}},[t._v("搜索")])],1)],1),i("v-uni-view",{staticStyle:{height:"104rpx"}}),i("v-uni-view",{staticClass:"hot opacity-hide"},[t.historyList.length>0?i("v-uni-view",{staticClass:"history"},[i("v-uni-view",{staticClass:"dir-left-wrap list"},[t._l(t.historyList,function(e,o){return[i("v-uni-view",{key:o+"_0",staticClass:"box-grow-0 cross-center item once-item"},[i("v-uni-view",{staticClass:"t-omit",staticStyle:{"max-width":"650rpx"}},[t._v(t._s(e.keyword))])],1)]})],2)],1):t._e()],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:!t.isSearch,expression:"!isSearch"}],staticClass:"hot"},[t.historyList.length>0?i("v-uni-view",{staticClass:"history"},[i("v-uni-view",{staticClass:"dir-left-nowrap cross-center title"},[i("v-uni-view",{staticClass:"box-grow-1"},[t._v("历史搜索")]),i("v-uni-image",{staticClass:"box-grow-0",attrs:{src:"../../static/image/icon/delete.png"},on:{click:function(e){e=t.$handleEvent(e),t.deleteHistory(e)}}})],1),i("v-uni-view",{staticClass:"dir-left-wrap list"},[i("v-uni-view",{staticClass:"dir-top-nowrap"},t._l(t.realHistoryList,function(e,o){return i("v-uni-view",{key:o,staticClass:"dir-left-wrap box-grow-1"},t._l(e,function(e,s){return i("v-uni-view",{key:s,staticClass:"dir-left-wrap"},[e.mark?t._e():i("v-uni-view",{staticClass:"box-grow-0 cross-center item",on:{click:function(i){i=t.$handleEvent(i),t.historyClick(e.keyword)}}},[i("v-uni-view",{staticClass:"t-omit",staticStyle:{"max-width":"650rpx"}},[t._v(t._s(e.keyword))])],1),e.mark&&1===o?i("v-uni-view",{staticClass:"box-grow-0 close-pic cross-center",on:{click:function(e){e=t.$handleEvent(e),t.selectAllList(e)}}},[i("v-uni-image",{attrs:{src:"./image/icon_open.png"}})],1):t._e()],1)}),1)}),1)],1)],1):t._e(),1==t.getSetting.is_show_hot_goods&&"goods"===t.sign?i("v-uni-view",{staticClass:"hot-center"},[i("v-uni-image",{staticClass:"top-image",attrs:{src:"./image/icon_top.png"}}),t.hotGoodsList&&t.hotGoodsList.length?i("v-uni-view",{staticClass:"top-list"},t._l(t.hotGoodsList,function(e,o){return i("v-uni-view",{key:o,staticClass:"item cross-center dir-left-nowrap",on:{click:function(i){i=t.$handleEvent(i),t.goodsNav(e.url)}}},[i("v-uni-view",{staticClass:"box-grow-0 main-center first"},[e.sort<4?i("v-uni-image",{attrs:{src:1===e.sort?"./image/list_icon_first.png":2===e.sort?"./image/list_icon_second.png":"./image/list_cion_third.png"}}):t._e(),e.sort>3?i("v-uni-view",[t._v(t._s(e.sort))]):t._e()],1),i("v-uni-view",{staticClass:"goods-image box-grow-0"},[i("v-uni-image",{attrs:{src:e.cover_pic}})],1),i("v-uni-view",{staticClass:"goods-name t-omit"},[t._v(t._s(e.title))])],1)}),1):t._e()],1):t._e()],1),t.isSearch?i("v-uni-view",{staticClass:"goods-list"},[t.list.length<=0?[i("v-uni-view",{staticClass:"main-center no-result"},[i("v-uni-view",{staticClass:"dir-left-nowrap cross-center"},[i("v-uni-image",{staticClass:"box-grow-0 empty",attrs:{src:"../../static/image/icon/empty.png"}}),i("v-uni-view",{staticClass:"box-grow-1"},[i("v-uni-view",[t._v("抱歉，没有相关商品")]),t.mch_id?t._e():i("v-uni-view",{staticClass:"text"},[t._v("以下是为您推荐的商品")])],1)],1)],1)]:t._e(),i("v-uni-view",{staticStyle:{"background-color":"#f7f7f7"}},[i("u-ordinary-list",{attrs:{"is-under-line-price":1==t.isListUnderlinePrice,"theme-object":t.themeObject,reset:t.goodsReset,pagination:!0,list:t.newList,theme:t.themeObject.theme,"show-buy-btn":"goods"===t.sign,"is-show-attr":!1,"list-style":2},on:{buyProduct:function(e){e=t.$handleEvent(e),t.buyProduct(e)}}})],1)],2):t._e(),t.loading?i("v-uni-view",{staticClass:"u-loading-list"},[t._v("加载中...")]):t._e()],1)],1),t.attrGoods.goods?i("u-attr",{attrs:{goods:t.attrGoods.goods,previewUrl:t.previewUrl,submitUrl:t.submitUrl,attrGroupList:t.attrGoods.goods.attr_groups,theme:t.themeObject.theme,"cart-show":"goods"===t.attrGoods.goods.type,show:t.attrGoods.attrShow}}):t._e()],1)},s=[];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return s})},e143f:function(t,e,i){"use strict";i.r(e);var o=i("bc2e"),s=i.n(o);for(var a in o)"default"!==a&&function(t){i.d(e,t,function(){return o[t]})}(a);e["default"]=s.a},e750:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".text-center[data-v-1e26ebaf]{text-align:center}.font-weight[data-v-1e26ebaf]{font-weight:700}.page-width[data-v-1e26ebaf]{width:100%}.goods-hover-class[data-v-1e26ebaf]{opacity:.9;background-color:#f7f7f7}.background-image[data-v-1e26ebaf]{background-repeat:no-repeat;background-size:100% 100%;background-position:50%}uni-page-body[data-v-1e26ebaf]{font-size:%?32?%;background:#f7f7f7}.page-width[data-v-1e26ebaf]{width:100%}.u-hover-class[data-v-1e26ebaf]{opacity:.9;background-color:#f7f7f7}.safe-area-inset-bottom[data-v-1e26ebaf]{padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.opacity-hide[data-v-1e26ebaf]{position:fixed;top:var(--window-top);z-index:-10;opacity:0;overflow:hidden}.search[data-v-1e26ebaf]{background-color:#efeff4}.close-pic[data-v-1e26ebaf]{margin-right:%?20?%;margin-bottom:%?16?%;border-radius:50%}.close-pic uni-image[data-v-1e26ebaf]{height:%?60?%;width:%?60?%;display:block}.hot[data-v-1e26ebaf]{background-color:#fafafa;border-radius:%?16?%}.hot .hot-center[data-v-1e26ebaf]{padding:%?32?% %?24?%}.hot .hot-center .top-image[data-v-1e26ebaf]{width:%?159?%;height:%?25?%;display:block}.hot .hot-center .top-list[data-v-1e26ebaf]{margin-top:%?32?%;border-radius:%?16?%;padding:%?22?% 0;-webkit-box-shadow:0 0 %?12?% 0 #e0e0e0;box-shadow:0 0 %?12?% 0 #e0e0e0}.hot .hot-center .top-list .item[data-v-1e26ebaf]{height:%?110?%}.hot .hot-center .top-list .item .first[data-v-1e26ebaf]{width:%?120?%;font-weight:700}.hot .hot-center .top-list .item .first uni-image[data-v-1e26ebaf]{width:%?48?%;height:%?43?%;display:block}.hot .hot-center .top-list .item .first uni-view[data-v-1e26ebaf]{color:#999;font-size:%?26?%}.hot .hot-center .top-list .item .goods-image uni-image[data-v-1e26ebaf]{height:%?90?%;width:%?90?%;display:block;border-radius:%?8?%}.hot .hot-center .top-list .item .goods-name[data-v-1e26ebaf]{color:#333;font-size:%?26?%;margin:0 %?24?%}.app-layout[data-v-1e26ebaf]{min-height:calc(100vh - var(--window-top))}.top[data-v-1e26ebaf]{position:fixed;width:100%;top:var(--window-top);z-index:15;padding:%?20?% %?24?%;background-color:#efeff4;font-size:%?32?%;color:#666}.top .input[data-v-1e26ebaf]{background-color:#fff;border-radius:%?50?% 0 0 %?50?%;padding:0 %?32?%;font-size:%?28?%;height:%?64?%}.top .box[data-v-1e26ebaf]{position:relative}.top .box .close-tip[data-v-1e26ebaf]{width:%?64?%;height:%?64?%;background-color:#fff;border-radius:0 %?50?% %?50?% 0;margin-right:%?20?%}.top .box .search-close[data-v-1e26ebaf]{width:%?32?%;height:%?32?%;border-radius:50%;margin:%?16?%}.top .radio[data-v-1e26ebaf]{margin-top:%?32?%}.top .radio .radio-item[data-v-1e26ebaf]{padding-bottom:%?12?%}.top .radio .active[data-v-1e26ebaf]{border-bottom:%?4?% solid}.history[data-v-1e26ebaf]{padding:%?36?% %?24?%;border-radius:%?16?% %?16?% 0 0;background-color:#fff;font-size:%?28?%}.history .title[data-v-1e26ebaf]{padding-bottom:%?24?%;color:#666}.history .title uni-image[data-v-1e26ebaf]{width:%?28?%;height:%?34?%;display:block}.history .list .item[data-v-1e26ebaf]{height:%?64?%;background-color:#f7f7f7;padding:0 %?20?%;margin-right:%?20?%;margin-bottom:%?16?%;border-radius:%?32?%}.goods-list .no-result[data-v-1e26ebaf]{height:%?156?%;padding:%?28?% 0;font-size:%?28?%;background-color:#fff}.goods-list .no-result .text[data-v-1e26ebaf]{color:#999}.goods-list .no-result .empty[data-v-1e26ebaf]{width:%?100?%;height:%?100?%;display:block;margin-right:%?40?%}.u-loading-list[data-v-1e26ebaf]{height:%?64?%;line-height:%?64?%;text-align:center;color:#b0b0b0;font-size:%?24?%;background-color:#f7f7f7}body.?%PAGE?%[data-v-1e26ebaf]{background:#f7f7f7}",""])}}]);