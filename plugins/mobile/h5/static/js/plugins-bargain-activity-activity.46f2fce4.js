(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plugins-bargain-activity-activity"],{"0b6b":function(t,i,a){"use strict";a.r(i);var e=a("f5db"),n=a.n(e);for(var o in e)"default"!==o&&function(t){a.d(i,t,function(){return e[t]})}(o);i["default"]=n.a},2300:function(t,i,a){var e=a("64b4");"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var n=a("4f06").default;n("609ec860",e,!0,{sourceMap:!1,shadowMode:!1})},"64b4":function(t,i,a){i=t.exports=a("2350")(!1),i.push([t.i,'.text-center[data-v-9fd92d46]{text-align:center}.font-weight[data-v-9fd92d46]{font-weight:700}.page-width[data-v-9fd92d46]{width:100%}.goods-hover-class[data-v-9fd92d46]{opacity:.9;background-color:#f7f7f7}.background-image[data-v-9fd92d46]{background-repeat:no-repeat;background-size:100% 100%;background-position:50%}uni-page-body[data-v-9fd92d46]{font-size:%?32?%;background:#f7f7f7}.page-width[data-v-9fd92d46]{width:100%}.u-hover-class[data-v-9fd92d46]{opacity:.9;background-color:#f7f7f7}.safe-area-inset-bottom[data-v-9fd92d46]{padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.goods-attr[data-v-9fd92d46]{margin-top:%?6?%;margin-bottom:%?16?%;color:#999;font-size:%?26?%;width:60%}.goods-attr uni-text[data-v-9fd92d46]{margin-right:%?18?%}.page[data-v-9fd92d46]{background:-webkit-gradient(linear,left top,left bottom,from(#ee3763),to(#fdac42));background:-o-linear-gradient(top,#ee3763,#fdac42);background:linear-gradient(180deg,#ee3763,#fdac42);padding-bottom:%?100?%;min-height:100%}.self-dialog[data-v-9fd92d46]{margin-bottom:%?14?%}.top-banner[data-v-9fd92d46]{width:100%;height:%?100?%;z-index:1}.rules[data-v-9fd92d46]{position:absolute;top:%?32?%;height:%?40?%;line-height:%?40?%;width:%?136?%;text-align:center;background-color:rgba(0,0,0,.2);border-radius:%?20?%;font-size:12px;color:#fff;z-index:2}.left-rules[data-v-9fd92d46]{left:%?20?%}.right-rules[data-v-9fd92d46]{right:%?20?%}.info[data-v-9fd92d46]{background-color:#fff;margin:0 %?20?%;position:relative;border-radius:%?16?%;text-align:center;font-size:16px;color:#353535;padding-top:%?65?%;padding-bottom:%?10?%}.info .avatar[data-v-9fd92d46]{position:absolute;top:%?-70?%;left:0;right:0;width:%?118?%;height:%?118?%;border-radius:50%;margin:0 auto;border:%?1?% solid #fff}.info .username[data-v-9fd92d46]{font-size:14px;color:#999;margin-bottom:%?20?%}.goods[data-v-9fd92d46]{margin:%?20?% %?24?% 0;padding:%?24?% 0;height:%?264?%;border-top:%?1?% solid #e2e2e2;text-align:left;font-size:14px;color:#353535}.goods uni-image[data-v-9fd92d46]{height:%?216?%;width:%?216?%;float:left;display:block;margin-right:%?20?%}.goods .end_time[data-v-9fd92d46]{font-size:14px;color:#666;margin-top:%?10?%}.end_time uni-text[data-v-9fd92d46]{margin:0 %?10?%}.end_time uni-text[data-v-9fd92d46]:last-of-type{margin:0 0 0 %?10?%}.goods .end_time .date-text[data-v-9fd92d46]{display:inline-block;color:#fff;height:%?46?%;line-height:%?46?%;text-align:center;width:%?46?%;margin:0;background-color:#666;border-radius:%?4?%}.goods .price[data-v-9fd92d46]{font-size:16px;color:#ff5c5c;margin-top:%?10?%}.progress[data-v-9fd92d46]{padding-top:%?56?%;height:%?180?%;width:%?680?%;margin:%?32?% auto 0;position:relative}.begin[data-v-9fd92d46],.progress-info[data-v-9fd92d46]{font-size:12px;color:#ff5c5c;padding:0 %?20?%;display:inline-block;border-radius:%?20?%;height:%?40?%;line-height:%?40?%;background-color:#fff;position:absolute;z-index:5;top:0;left:5%;margin-left:%?-68?%;white-space:nowrap}.progress-info.progressing[data-v-9fd92d46]{margin-left:%?-68?%;min-width:%?82?%;white-space:nowrap}.progress-info[data-v-9fd92d46]:after{content:"";position:absolute;top:%?40?%;left:50%;margin-left:%?-8?%;border:%?8?% solid rgba(0,0,0,0);border-top-color:#fff}.progress .border[data-v-9fd92d46]{position:absolute;top:%?40?%;margin-left:%?-8?%;border:%?8?% solid rgba(0,0,0,0);border-top-color:#fff}.progress-info.over[data-v-9fd92d46]:after{left:75%}.progress-info.over[data-v-9fd92d46]{left:97%;margin-left:%?-68?%;white-space:nowrap}.progress .progress-bg[data-v-9fd92d46]{width:%?680?%;height:%?28?%;position:relative}.progress .progress-bg uni-image[data-v-9fd92d46]{width:%?680?%;height:%?28?%;position:absolute}.progress .line[data-v-9fd92d46]{position:absolute;top:%?2?%;left:%?2?%;height:%?24?%;background-color:#ff9f9f;border-radius:%?12?%;z-index:5;max-width:%?676?%}.progress .line.small-line[data-v-9fd92d46]{border-top-right-radius:0;border-bottom-right-radius:0}.after-price[data-v-9fd92d46],.before-price[data-v-9fd92d46]{font-size:12px;color:#fff;position:absolute;bottom:%?40?%}.before-price[data-v-9fd92d46]{left:0}.after-price[data-v-9fd92d46]{right:0}.button-view[data-v-9fd92d46]{height:%?122?%;padding-bottom:%?40?%;margin:0 %?20?%}.button-view uni-button[data-v-9fd92d46]{height:%?82?%;width:%?328?%;padding:0;margin:0;border-radius:%?41?%}.button-view uni-image[data-v-9fd92d46]{height:%?82?%;width:%?328?%}.log[data-v-9fd92d46]{background-color:hsla(0,0%,100%,.3);margin:0 %?20?%;padding:%?40?%;border-radius:%?16?%;position:relative}.log-line[data-v-9fd92d46]{position:absolute;top:%?60?%;left:50%;height:%?1?%;width:%?160?%;background-color:#fff}.log .log-line[data-v-9fd92d46]:first-of-type{margin-left:%?-254?%}.log .log-line[data-v-9fd92d46]:last-of-type{margin-left:%?94?%}.log-title[data-v-9fd92d46]{color:#fff;font-size:14px;margin:0 %?34?%}.log-item[data-v-9fd92d46]{margin-top:%?40?%;height:%?80?%;line-height:%?80?%;color:#fff}.log-item .log-user[data-v-9fd92d46]{float:left;width:50%}.log-item .log-user uni-image[data-v-9fd92d46]{height:%?80?%;width:%?80?%;border-radius:50%;margin-right:%?24?%;float:left}.log-item .log-info[data-v-9fd92d46]{float:right;width:50%;text-align:right}.log-item .log-info uni-text[data-v-9fd92d46]{float:right}.log-item .log-info uni-image[data-v-9fd92d46]{margin-top:%?15?%;height:%?50?%;width:%?72?%;margin-right:%?16?%}.look-more[data-v-9fd92d46],.up[data-v-9fd92d46]{margin-top:%?48?%;width:100%;font-size:12px;color:#fff;text-align:center}.look-more uni-image[data-v-9fd92d46],.up uni-image[data-v-9fd92d46]{height:%?18?%;width:%?18?%;margin-right:%?16?%}.join[data-v-9fd92d46]{height:%?152?%}.dialog-bg[data-v-9fd92d46]{height:100%;width:100%;position:fixed;left:0;top:0;z-index:10;background-color:rgba(0,0,0,.3)}.dialog-header[data-v-9fd92d46]{position:absolute;left:0;right:0;top:0;margin:0 auto;height:%?200?%;width:%?638?%;z-index:15}.dialog-header-gif[data-v-9fd92d46]{position:absolute;left:0;right:0;top:%?34?%;margin:0 auto;height:%?69?%;width:%?132?%;z-index:20}.dialog-header-gif-sec[data-v-9fd92d46]{position:absolute;left:0;right:0;top:%?-70?%;margin:0 auto;height:%?276?%;width:%?525?%;z-index:20;-webkit-transform:scale(.25);-ms-transform:scale(.25);transform:scale(.25)}.dialog[data-v-9fd92d46]{padding:%?60?% 0 %?48?%;background-color:#fff;position:fixed;top:%?504?%;left:0;right:0;margin:0 auto;width:%?638?%;text-align:center;border-bottom-left-radius:%?16?%;border-bottom-right-radius:%?16?%}.dialog uni-image[data-v-9fd92d46]{margin-top:%?45?%;height:%?88?%;width:%?480?%}.button-margin[data-v-9fd92d46]{margin-top:%?45?%}.button-margin uni-button[data-v-9fd92d46]{border:0}.dialog uni-button[data-v-9fd92d46]{background-color:#fff}.dialog .price[data-v-9fd92d46]{color:#ff5c5c;font-size:16px;font-weight:blod}.dialog-close[data-v-9fd92d46]{height:%?50?%;width:%?50?%;position:fixed;top:%?320?%;right:%?62?%;z-index:20}.in-bargain[data-v-9fd92d46]{position:fixed;top:%?300?%;left:0;right:0;margin:0 auto;width:%?638?%;height:%?535?%;border-radius:%?16?%;background-color:#fff}.bargain-gif[data-v-9fd92d46]{display:block;position:absolute;top:%?147.5?%;left:0;right:0;height:%?240?%;width:%?310?%;margin:0 auto}.bargain-gif-bg[data-v-9fd92d46]{display:block;position:absolute;top:0;left:0;right:0;height:%?500?%;width:%?500?%;margin:0 auto}uni-page-body[data-v-9fd92d46]{height:100%}.nickname[data-v-9fd92d46]{white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;display:inline-block;width:65%}.dialog-item[data-v-9fd92d46]{position:fixed;top:%?400?%;left:0;right:0;height:%?300?%;width:%?640?%;margin:0 auto;z-index:21;background-color:#fff;border-radius:%?20?%;text-align:center;font-size:%?30?%}.close-button[data-v-9fd92d46]{height:%?88?%;width:%?640?%;border-top:%?1?% solid #e2e2e2;line-height:%?88?%;color:#ff4544;position:absolute;bottom:0;left:0}.dialog-tip-title[data-v-9fd92d46]{margin:%?40?% auto %?35?%}.join-img[data-v-9fd92d46]{width:%?680?%;height:%?110?%}.goods-name[data-v-9fd92d46]{margin-top:%?6?%}body.?%PAGE?%[data-v-9fd92d46]{background:#f7f7f7}',""])},"80ff":function(t,i,a){"use strict";a.r(i);var e=a("c0a2"),n=a("0b6b");for(var o in n)"default"!==o&&function(t){a.d(i,t,function(){return n[t]})}(o);a("a2d2");var r=a("2877"),d=Object(r["a"])(n["default"],e["a"],e["b"],!1,null,"9fd92d46",null);i["default"]=d.exports},a2d2:function(t,i,a){"use strict";var e=a("2300"),n=a.n(e);n.a},c0a2:function(t,i,a){"use strict";var e=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("app-layout",[a("v-uni-view",{staticStyle:{height:"100%","padding-bottom":"0",background:"linear-gradient(to bottom, #ee3763, #fdac42)",position:"absolute",width:"100%"}},[a("v-uni-view",{staticClass:"page"},[t.dialog?a("v-uni-view",{staticClass:"dialog-bg"},[a("v-uni-view",{staticClass:"in-bargain"},[t.kanjia?a("v-uni-image",{staticClass:"bargain-gif-bg",attrs:{src:"./../image/light.png"}}):t._e(),t.kanjia?a("v-uni-image",{staticClass:"bargain-gif",attrs:{src:t.bargainImg.app_image.activity_header}}):t._e(),t.kanjia?t._e():a("v-uni-image",{staticClass:"dialog-header",attrs:{src:t.bargainImg.app_image.header}}),t.kanjia?t._e():a("v-uni-image",{staticClass:"dialog-header-gif-sec",attrs:{animation:t.animationData,src:t.bargainImg.app_image.top1}}),t.kanjia?t._e():a("v-uni-view",{on:{click:function(i){i=t.$handleEvent(i),t.dialog=!1}}},[a("v-uni-image",{staticClass:"dialog-close",attrs:{src:"./../image/close.png"}})],1),t.kanjia?t._e():a("v-uni-view",{staticClass:"dialog"},[a("v-uni-view",{staticClass:"self-dialog"},[t.bargain.user_id==t.info.user_id?a("v-uni-view",[t._v("你一出手就帮自己砍掉了"),a("v-uni-text",{staticClass:"price"},[t._v(t._s(t.info.price)+"元")])],1):t._e(),t.bargain.user_id!=t.info.user_id?a("v-uni-view",[t._v("你一出手就帮"+t._s(t.bargain.nickname))]):t._e(),t.bargain.user_id!=t.info.user_id?a("v-uni-view",[t._v("砍了"),a("v-uni-text",{staticClass:"price"},[t._v(t._s(t.info.price)+"元")])],1):t._e()],1),t.bargain.user_id==t.info.user_id?a("v-uni-view",[t._v("快邀请好友帮你一起砍价吧！")]):t._e(),a("v-uni-view",{staticClass:"button-margin"},[t.bargain.user_id==t.info.user_id?a("v-uni-button",{attrs:{"open-type":"share"},on:{click:function(i){i=t.$handleEvent(i),t.hShareAppMessage(i)}}},[a("v-uni-image",{staticStyle:{"margin-top":"0"},attrs:{src:t.bargainImg.app_image.find}})],1):t._e()],1),t.bargain.user_id!=t.info.user_id?a("v-uni-view",{on:{click:function(i){i=t.$handleEvent(i),t.toJoin(i)}}},[a("v-uni-image",{attrs:{src:t.bargainImg.app_image.join_small}})],1):t._e()],1)],1)],1):t._e(),t.tip?a("v-uni-view",{staticClass:"dialog-bg"},[a("v-uni-view",{staticClass:"dialog-item"},[a("v-uni-view",{staticClass:"dialog-tip-title"},[t._v("提示")]),a("v-uni-view",[t._v(t._s(t.tip))]),a("v-uni-view",{staticClass:"close-button",on:{click:function(i){i=t.$handleEvent(i),t.tip=""}}},[t._v("确认")])],1)],1):t._e(),a("v-uni-view",[a("v-uni-view",{staticClass:"rules left-rules",on:{click:function(i){i=t.$handleEvent(i),t.toIndex(i)}}},[t._v("返回首页")])],1),a("v-uni-view",[a("v-uni-view",{staticClass:"rules right-rules",on:{click:function(i){i=t.$handleEvent(i),t.toRules(i)}}},[t._v("活动规则")])],1),a("v-uni-image",{staticClass:"top-banner",attrs:{src:t.bargainImg.app_image.top}}),a("v-uni-view",{staticClass:"info"},[a("v-uni-image",{staticClass:"avatar",attrs:{src:t.detail.initiator_avatar}}),a("v-uni-view",{staticClass:"username"},[t._v(t._s(t.detail.initiator_nickname))]),a("v-uni-view",[t._v("我发现一件好货，来一起砍价优惠购！")]),a("v-uni-view",{staticClass:"goods"},[a("v-uni-image",{attrs:{src:t.detail.cover_pic}}),a("v-uni-view",{staticClass:"t-omit-two goods-name"},[t._v(t._s(t.detail.goods_name))]),a("v-uni-view",{staticClass:"t-omit goods-attr"},t._l(t.detail.select_attr_group,function(i){return a("v-uni-text",{key:i.id},[t._v(t._s(i.attr_group_name)+":"+t._s(i.attr_name))])}),1),t.detail.reset_time>0?a("v-uni-view",{staticClass:"end_time"},[t.dd>0?a("v-uni-text",{staticClass:"date-text"},[t._v(t._s(t.dd))]):t._e(),t.dd>0?a("v-uni-text",[t._v("天")]):t._e(),a("v-uni-text",{staticClass:"date-text"},[t._v(t._s(t.hh))]),a("v-uni-text",[t._v(":")]),a("v-uni-text",{staticClass:"date-text"},[t._v(t._s(t.mm))]),a("v-uni-text",[t._v(":")]),a("v-uni-text",{staticClass:"date-text"},[t._v(t._s(t.ss))]),a("v-uni-text",[t._v("后结束")])],1):a("v-uni-view",{staticClass:"end_time"},[t._v("已结束")]),a("v-uni-view",{staticClass:"price"},[t._v("当前价 ￥"+t._s(t.detail.now_price?t.detail.now_price:0))])],1)],1),a("v-uni-view",{staticClass:"progress"},[t.detail.bargain_price_per<5?a("v-uni-view",{staticClass:"border",style:{left:t.detail.bargain_price_per+"%"}}):t._e(),t.detail.bargain_price_per<5?a("v-uni-text",{staticClass:"begin"},[t._v("已砍"+t._s(t.detail.bargain_price?t.detail.bargain_price:0))]):t.detail.bargain_price_per<100?a("v-uni-text",{staticClass:"progress-info progressing",style:{left:(t.detail.bargain_price_per?t.detail.bargain_price_per:0)+"%"}},[t._v("已砍"+t._s(t.detail.bargain_price?t.detail.bargain_price:0))]):a("v-uni-text",{staticClass:"progress-info over"},[t._v("已完成")]),a("v-uni-view",{staticClass:"progress-bg"},[a("v-uni-image",{attrs:{src:"./../image/progress.png"}}),a("v-uni-view",{staticClass:"line",class:[t.detail.bargain_price<4?"small-line":""],style:{width:(t.detail.bargain_price_per?t.detail.bargain_price_per:0)+"%"}})],1),a("v-uni-text",{staticClass:"before-price"},[t._v("原价￥"+t._s(t.detail.price?t.detail.price:0))]),a("v-uni-text",{staticClass:"after-price"},[t._v("底价￥"+t._s(t.detail.min_price?t.detail.min_price:0))])],1),2==t.status?a("v-uni-view",{staticClass:"join main-center"},[a("v-uni-view",{on:{click:function(i){i=t.$handleEvent(i),t.toJoin(i)}}},[a("v-uni-image",{staticClass:"join-img",attrs:{animation:t.sizeAnimation,src:t.bargainImg.app_image.join_big}})],1)],1):t._e(),t.detail.now_price!=t.detail.min_price&&2!=t.status?a("v-uni-view",{staticClass:"button-view main-between"},[a("v-uni-view",{on:{click:function(i){i=t.$handleEvent(i),t.toBuy(i)}}},[a("v-uni-image",{attrs:{src:t.bargainImg.app_image.buy_small}})],1),a("v-uni-button",{attrs:{"open-type":"share"},on:{click:function(i){i=t.$handleEvent(i),t.hShareAppMessage(i)}}},[a("v-uni-image",{attrs:{src:t.bargainImg.app_image.go_on}})],1)],1):t._e(),t.detail.now_price==t.detail.min_price&&2!=t.status?a("v-uni-view",{staticClass:"join main-center"},[a("v-uni-view",{on:{click:function(i){i=t.$handleEvent(i),t.toBuy(i)}}},[a("v-uni-image",{staticClass:"join-img",attrs:{animation:t.sizeAnimation,src:t.bargainImg.app_image.buy_now}})],1)],1):t._e(),a("v-uni-view",{staticClass:"log"},[a("v-uni-view",{staticClass:"main-center"},[a("v-uni-text",{staticClass:"log-line"}),a("v-uni-text",{staticClass:"log-title"},[t._v("砍价记录")]),a("v-uni-text",{staticClass:"log-line"})],1),t._l(t.list,function(i){return a("v-uni-view",{key:i.id,staticClass:"log-item"},[a("v-uni-view",{staticClass:"log-user"},[a("v-uni-image",{attrs:{src:i.avatar}}),a("v-uni-text",{staticClass:"nickname"},[t._v(t._s(i.nickname))])],1),a("v-uni-view",{staticClass:"log-info"},[a("v-uni-image",{attrs:{src:"./../image/down.png"}}),a("v-uni-text",[t._v("砍掉"+t._s(i.price)+"元")])],1)],1)}),t.toMore?a("v-uni-view",{on:{click:function(i){i=t.$handleEvent(i),t.lookMore(i)}}},[t.more?a("v-uni-view",{staticClass:"look-more"},[a("v-uni-image",{attrs:{src:"./../image/to-down.png"}}),a("v-uni-text",[t._v("查看更多")])],1):a("v-uni-view",{staticClass:"up",attrs:{catchtap:"closeList"}},[a("v-uni-image",{attrs:{src:"./../image/to-up.png"}}),a("v-uni-text",[t._v("收起")])],1)],1):t._e()],2)],1)],1)],1)},n=[];a.d(i,"a",function(){return e}),a.d(i,"b",function(){return n})},f5db:function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e=a("2f62");function n(t,i){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),a.push.apply(a,e)}return a}function o(t){for(var i=1;i<arguments.length;i++){var a=null!=arguments[i]?arguments[i]:{};i%2?n(a,!0).forEach(function(i){r(t,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):n(a).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(a,i))})}return t}function r(t,i,a){return i in t?Object.defineProperty(t,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[i]=a,t}var d={name:"activity",data:function(){return{detail:{bargain_price_per:0},list:[],distance:0,more:!1,sizeAnimation:{},status:1,animationData:"",kanjia:!1,dialog:!1,info:{},bargain:{},toMore:!1,page:1,dd:0,hh:23,mm:59,ss:59,changeTimer:null,timer:null,tip:"",title:"",order_id:""}},computed:o({},(0,e.mapState)({userInfo:function(t){return t.user.info},bargainImg:function(t){return t.mallConfig.plugin.bargain},mall:function(t){return t.mallConfig.mall}})),onUnload:function(){clearInterval(this.timer),clearInterval(this.changeTimer)},onLoad:function(t){var i=this;i.$store.dispatch("user/info"),i.$showLoading({type:"global",text:"加载中..."}),i.getSetting();var a=setInterval(function(){i.userInfo&&(clearInterval(a),t.order_id?(i.join(t.order_id),i.order_id=t.order_id):t.id?(i.getDetail(t.id,1),i.order_id=t.id):t.bargain_order_id&&(i.order_id=t.bargain_order_id,t.user_id==i.userInfo.options.user_id?i.getDetail(t.bargain_order_id,1):(i.status=2,i.join(t.bargain_order_id))),i.changeTimer=setInterval(function(){i.changeSize()},300))},300)},methods:{hShareAppMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this;return this.$shareAppMessage({title:i.title,path:"/plugins/bargain/activity/activity",imageUrl:i.detail.app_share_pic?i.detail.app_share_pic:"",params:{user_id:i.userInfo.options.user_id,bargain_order_id:i.order_id}},t)},toRules:function(){uni.navigateTo({url:"/pages/rules/index?url=".concat(encodeURIComponent(this.$api.bargain.setting),"&key=rule")})},getSetting:function(){var t=this;t.$request({url:t.$api.bargain.setting}).then(function(i){if(0===i.code){if(t.title=i.data.title.toString(),i.data.title.indexOf("\n")>-1){var a=i.data.title.split("\n"),e=Math.floor(Math.random()*a.length);t.title=a[e]}}else uni.showToast({title:i.msg,icon:"none",duration:1e3})}).catch(function(i){t.$hideLoading()})},join:function(t){var i=this;i.$request({url:i.$api.bargain.user_join_bargain,data:{bargain_order_id:t}}).then(function(a){if(0==a.code){var e=a.data.queueId,n=a.data.token;i.result(e,n,t)}else uni.showToast({title:a.msg,icon:"none",duration:1e3}),"用户已参与本次砍价"==a.msg&&i.getDetail(t,1)}).catch(function(t){i.$hideLoading()})},result:function(t,i,a){var e=this;e.$request({url:e.$api.bargain.user_join_bargain_result,data:{queueId:t,token:i}}).then(function(n){0==n.code?1==n.data.retry?setTimeout(function(){e.result(t,i,a)},1e3):(e.$hideLoading(),e.info=n.data.info,e.bargain=n.data.bargain,e.bargainAnimation(),e.getDetail(a,1)):"已砍至最低价"==n.msg?(e.tip=n.msg,e.getDetail(a,1)):uni.showToast({title:n.msg,icon:"none",duration:1e3})}).catch(function(t){e.$hideLoading()})},getDetail:function(t,i){var a=this;a.$request({url:a.$api.bargain.activity,data:{bargain_order_id:t,page:i}}).then(function(t){if(setTimeout(function(){a.$hideLoading()},500),0==t.code)if(t.data.list.length>0){if(a.detail=t.data,t.data.total_people>3&&(a.toMore=!0,3==t.data.list.length?a.more=!0:a.more=!1),a.list=a.list.concat(t.data.list),1==i){var e=a.detail.reset_time;a.timer=setInterval(function(){e--,a.getTime(e),0==a.reset_time&&clearInterval(a.timer)},1e3)}}else a.tip="暂无更多用户",a.toMore=!1;else uni.showModal({title:"提示",content:t.data.msg,showCancel:!1,success:function(t){t.confirm&&uni.redirectTo({url:"/pages/index/index"})}})}).catch(function(t){a.$hideLoading()})},getTime:function(t){t>86399?(this.dd=Math.floor(t/86400),t-=86400*this.dd):this.dd=0,t>3599?(this.hh=Math.floor(t/3600),this.hh<10&&(this.hh="0"+this.hh),t-=3600*this.hh):this.hh="00",t>59?(this.mm=Math.floor(t/60),this.mm<10&&(this.mm="0"+this.mm),t-=60*this.mm):this.mm="00",t<60&&(this.ss=t,this.ss<10&&(this.ss="0"+this.ss))},bargainAnimation:function(){var t=this;t.kanjia=!0,t.dialog=!0,setTimeout(function(){t.kanjia=!1,t.success()},1200),t.$forceUpdate()},lookMore:function(){this.page++,this.getDetail(this.order_id,this.page)},closeList:function(){this.list=this.list.slice(0,3),this.page=1,this.more=!0},success:function(){this.dialog=!0;var t=uni.createAnimation({duration:500,timingFunction:"linear"});this.animation=t,t.scale(1).step().rotate(2).step().rotate(-2).step().rotate(0).step(),this.animationData=t.export()},changeSize:function(){var t=uni.createAnimation({duration:1e3,timingFunction:"linear"});this.size=t,t.scale(.8).step().scale(1).step(),this.sizeAnimation=t.export()},toIndex:function(){uni.reLaunch({url:"/pages/index/index"})},toBuy:function(){var t=this.detail,i=[{mch_id:0,bargain_order_id:t.bargain_order_id,goods_list:[{id:t.goods_id,attr:[],num:1,cart_id:0,goods_attr_id:t.goods_attr_id}]}];uni.navigateTo({url:"/pages/order-submit/order-submit?mch_list="+JSON.stringify(i)+"&preview_url="+encodeURIComponent(this.$api.bargain.order_preview)+"&submit_url="+encodeURIComponent(this.$api.bargain.order_submit)})},toJoin:function(){this.detail.goods_id?uni.navigateTo({url:"/plugins/bargain/goods/goods?goods_id="+this.detail.goods_id}):uni.showModal({title:"提示",content:"活动已结束",showCancel:!1,success:function(t){t.confirm&&uni.redirectTo({url:"/pages/index/index"})}})}}};i.default=d}}]);