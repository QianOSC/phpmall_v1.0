(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["plugins-scan_code-index-index"],{"1db3":function(a,t){a.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAMAAADW3miqAAAAYFBMVEUAAACtra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra2tra0WMtvAAAAAH3RSTlMAYg+dc6jo07cGW0xpPDDNxpWRiYUe21Mm8L97QzYYIzOmfgAAAV9JREFUOMt9k+uSQ0AQhZsxF8RdCDb53v8tt5JSS0/Jnj8Mn+nW54xo3eetH7PiIV9VmYldLpSXyI8HlsZ2nWkd4BKJ9bLg+lp2PTYPzTOqtMCYq0c3B2qzEsJdIuUdZIrp5EK3E/WCXi6VwM9+27DKF42Q7/iSqje1HGown+tCoYbe0BwfPeC9KHBqnwGojmX4bOXJFJTBlJ5qg0gOuR5Ptqm1o5ISL//KMMiAicOgnS2wYqOWigAqTk9WCdzOeXEQQTWttGco99aCkxgKqlwuK5gIWmXQAUgB3XiJlZlWhRjQgezpJIXIdv+uesgzi0wUynXszd9P4YdP/CbdEsxq4OF9gUpBQ3r+kX1qG9PZk5dq2xJ2n3XEtXHs/dVqNNq3w48EsiumBKPSOF4eOxsdMF9qpA7EvVYThCI/KlmgkFgZQDsk5ZyM6wKY9KLNNGv5kx8Oa2Ju3vrOmDHRxC9lch6LtN1nUgAAAABJRU5ErkJggg=="},"3fcbd":function(a,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={name:"index",components:{},data:function(){return{page_loading:!0,tmp_price:"",clerk_user_id:0,edit_status:!0,price_modal:!1,activity:{},remark:"",integral:{user_integral_num:"0"},list:{price:"",pay_price:0,use_integral:0,activity_id:0,coupon_id:0,can_coupon_num:0,integral_explain:[]},clear:!1}},onShow:function(){var a=this,t=a.$store.state.scanCode.userCoupon;if(t?(a.list.coupon_id=-1==t?0:t.id,a.calcPrice()):a.list.coupon_id=0,a.clear){var i=[!0,!1,"","",{price:"",pay_price:0,use_integral:0,activity_id:0,coupon_id:0,can_coupon_num:0,integral_explain:[]}];a.edit_status=i[0],a.clear=i[1],a.remark=i[2],a.tmp_price=i[3],a.list=i[4]}},onLoad:function(a){var t=this;if(t.$store.commit("scanCode/mutSetUserCoupon",0),t.clear=!0,a.clerk_user_id&&(t.clerk_user_id=a.clerk_user_id),a.price){var i=[!1,a.price];t.edit_status=i[0],t.tmp_price=i[1],t.calcPrice()}t.$showLoading({text:"加载中"}),t.$request({url:t.$api.scan_code_pay.index}).then(function(a){if(t.$hideLoading(),0===a.code){var i=[a.data.activity?a.data.activity:{},a.data.goods,a.data.integral,a.data.setting];t.activity=i[0],t.goods=i[1],t.integral=i[2],t.setting=i[3]}}).catch(function(a){t.$hideLoading()})},methods:{openPriceModel:function(){this.edit_status&&(this.price_modal=!0)},closePriceModel:function(){this.price_modal=!1},setTempInput:function(a){this.tmp_price=this.money(a.detail.value)},money:function(a){var t=a.toString();return 0==t.indexOf(".")&&(t="0"+t),t=t.replace(/[^\d.]/g,""),t=t.replace(/\.{2,}/g,"."),t=t.replace(".","$#$").replace(/\./g,"").replace("$#$","."),t=t.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),t.indexOf(".")<0&&""!=t&&(t=parseFloat(t)),+t},priceChange:function(){this.tmp_price>1e5&&(this.tmp_price=1e5)},calcPrice:function(){var a=this;a.priceChange(),a.price_modal=!1,a.$showLoading({text:"加载中"}),a.$request({url:a.$api.scan_code_pay.preview,data:{price:a.tmp_price,coupon_id:a.list.coupon_id,use_integral:a.list.use_integral,clerk_user_id:a.clerk_user_id},method:"POST"}).then(function(t){if(a.$hideLoading(),0===t.code){var i=[t.data,t.data.price];a.list=i[0],a.tmp_price=i[1]}else uni.showToast({icon:"none",title:t.msg})}).catch(function(t){a.$hideLoading()})},handleUseIntegral:function(){var a=this,t=a.list;t.use_integral=1==t.use_integral?0:1,a.calcPrice()},bindTextBlur:function(a){this.remark=a.detail.value},getIntegralInfo:function(a){var t="";this.list.integral_explain.map(function(a){t+="消费满"+a.consume_money+"元，",t+="积分最多可抵"+a.integral_deduction+"元",t+="\r\n"}),uni.showModal({title:"积分抵扣说明",content:t.trim(),showCancel:!1})},setCoupon:function(a){this.clear=!1,uni.navigateTo({url:"/plugins/scan_code/index/coupon?price="+this.list.price+"&coupon_id="+this.list.coupon_id})},submit:function(a){var t=this;t.list.price&&(t.$showLoading({text:"正在提交"}),t.$request({url:t.$api.scan_code_pay.submit,method:"post",data:{price:t.list.price,coupon_id:t.list.coupon_id,use_integral:t.list.use_integral,remark:t.remark,clerk_user_id:t.clerk_user_id}}).then(function(a){t.$hideLoading(),0===a.code?t.$payment.pay(a.data.pay_id).then(function(i){t.$store.commit("scanCode/mutSetUserCoupon",""),uni.showModal({title:"提示",content:"支付成功",showCancel:!1,success:function(){uni.navigateTo({url:"/pages/order-submit/pay-result?payment_order_union_id="+a.data.pay_id+"&plugin=scan_code_pay"}),t.clear=!0}})}).catch(function(i){t.$showLoading({text:"取消中"}),t.$request({url:t.$api.scan_code_pay.cancel,data:{pay_id:a.data.pay_id},method:"POST"}).then(function(a){t.$hideLoading()}).catch(function(a){t.$hideLoading(),uni.showModal({title:"提示",content:a.msg})})}):uni.showModal({title:"提示",content:info.msg})}).catch(function(a){t.$hideLoading()}))}}};t.default=e},"92c0":function(a,t,i){"use strict";i.r(t);var e=i("e39a"),n=i("9812");for(var o in n)"default"!==o&&function(a){i.d(t,a,function(){return n[a]})}(o);i("f48d1");var s=i("2877"),r=Object(s["a"])(n["default"],e["a"],e["b"],!1,null,"46d13a44",null);t["default"]=r.exports},9432:function(a,t,i){var e=i("b041");t=a.exports=i("2350")(!1),t.push([a.i,".text-center[data-v-46d13a44]{text-align:center}.font-weight[data-v-46d13a44]{font-weight:700}.page-width[data-v-46d13a44]{width:100%}.goods-hover-class[data-v-46d13a44]{opacity:.9;background-color:#f7f7f7}.background-image[data-v-46d13a44]{background-repeat:no-repeat;background-size:100% 100%;background-position:50%}uni-page-body[data-v-46d13a44]{font-size:%?32?%;background:#f7f7f7}.page-width[data-v-46d13a44]{width:100%}.u-hover-class[data-v-46d13a44]{opacity:.9;background-color:#f7f7f7}.safe-area-inset-bottom[data-v-46d13a44]{padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.red[data-v-46d13a44]{color:#ff4544}.gray[data-v-46d13a44]{color:#999}.scan-head[data-v-46d13a44]{margin:%?20?% %?24?% 0 %?24?%;background:#fff;border-radius:%?16?%;padding:%?48?% %?40?% 0 %?40?%;font-size:%?28?%;color:#353535}.scan-head .scan-line[data-v-46d13a44]{height:1px;margin-top:%?38?%;background:#e2e2e2}.scan-head .scan-price[data-v-46d13a44]{margin-top:%?32?%}.scan-head .scan-price .order-key[data-v-46d13a44]{font-size:%?50?%}.scan-head .scan-price .order-value[data-v-46d13a44]{font-size:%?80?%;padding-left:%?28?%;height:%?98?%}.scan-offer[data-v-46d13a44]{color:#666;font-size:%?28?%;margin-top:%?40?%}.scan-offer .coupon-right[data-v-46d13a44]{padding-right:%?12?%}.scan-offer .icon-right[data-v-46d13a44]{background-size:100% auto;background-repeat:no-repeat;background-image:url("+e(i("db8d"))+");width:%?12?%;height:%?22?%}.scan-integral-icon[data-v-46d13a44]{height:%?36?%;width:%?36?%;background-image:url("+e(i("1db3"))+");background-repeat:no-repeat;background-size:100% auto;margin-left:%?20?%}.scan-integral-switch[data-v-46d13a44]{width:%?44?%;height:%?44?%;background-size:100% auto;background-repeat:no-repeat;float:left}.scan-integral-switch.check[data-v-46d13a44]{margin-left:%?5?%;background-image:url("+e(i("afd4"))+")}.scan-integral-switch.uncheck[data-v-46d13a44]{margin-left:%?5?%;background-image:url("+e(i("cf9d"))+")}.scan-input[data-v-46d13a44]{width:100%;font-size:%?28?%;color:#666}.scan-remark[data-v-46d13a44]{height:%?106?%}.scan-remark .key[data-v-46d13a44]{margin-left:auto;color:#353535;font-size:%?28?%}.scan-remark .value[data-v-46d13a44]{margin-left:%?10?%;color:#ff4544;font-size:%?36?%}.scan-end[data-v-46d13a44]{color:#666;background:#fff;margin:0 %?24?%;font-size:%?28?%;border-radius:%?16?%;padding:%?40?%}.scan-end uni-text[data-v-46d13a44]{word-break:break-all;text-align:justify}.scan-end>uni-view[data-v-46d13a44]{margin-bottom:%?12?%}.scan-end .icon[data-v-46d13a44]{height:%?26?%;width:%?8?%;border-radius:%?4?%;background:#ff4544;margin-right:%?16?%}.scan-btn[data-v-46d13a44]{margin:%?40?% auto}.scan-modal[data-v-46d13a44]{position:fixed;left:0;top:0;width:100%;height:100%;z-index:2001;-webkit-transition:.2s;-o-transition:.2s;transition:.2s}.scan-modal.show[data-v-46d13a44]{visibility:visible;opacity:1}.scan-modal.bt[data-v-46d13a44]{-webkit-animation-name:fadeIn;-webkit-animation-duration:.25s;-webkit-animation-iteration-count:1;-webkit-animation-delay:0s}.scan-modal .scan-modal-bg[data-v-46d13a44]{background:rgba(0,0,0,.8);position:fixed;left:0;top:0;width:100%;height:100%;z-index:1}.scan-modal .scan-modal-pic[data-v-46d13a44]{position:fixed;left:0;top:%?188?%;width:100%;height:100%;z-index:1}.scan-modal .scan-modal-close uni-image[data-v-46d13a44]{width:%?50?%;height:%?50?%;margin-top:%?50?%}.scan-modal .info-model[data-v-46d13a44]{height:%?360?%;width:%?620?%;background:#fff;border-radius:%?16?%}.scan-modal .order-title[data-v-46d13a44]{margin:%?48?% 0}.scan-modal .place[data-v-46d13a44]{color:#cdcdcd}.scan-modal .info-box[data-v-46d13a44]{height:%?88?%;width:%?400?%;margin-bottom:%?48?%;border-radius:%?8?%;padding:0 %?24?%;border:1px solid #e2e2e2}.scan-modal .info-input[data-v-46d13a44]{font-size:%?32?%;color:#353535}.scan-modal .info-line[data-v-46d13a44]{height:%?32?%!important;width:1px!important;background:#e2e2e2}.scan-modal .info-end[data-v-46d13a44]{color:#666;height:%?88?%;font-size:%?32?%;border-top:%?1?% solid #e2e2e2;width:100%}.scan-modal .info-end uni-view[data-v-46d13a44]{height:100%;width:100%}body.?%PAGE?%[data-v-46d13a44]{background:#f7f7f7}",""])},9812:function(a,t,i){"use strict";i.r(t);var e=i("3fcbd"),n=i.n(e);for(var o in e)"default"!==o&&function(a){i.d(t,a,function(){return e[a]})}(o);t["default"]=n.a},afd4:function(a,t){a.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAYFBMVEUAAAD/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFz/XFx/A+xKAAAAH3RSTlMA6dzyFC/u+OMnCriuijh2yR/Qfj8allZQRyKjbWdg2KCSBwAAAVdJREFUOMuN1OmugyAQBeADKCqudam127z/W95MbLgiiny/aHpyMk6p2GvaqhNKie7VpghKB0kbMpBvSvKUI44kNR2qn/AUgk5kXvk3o3MtHA9icemZLrxhTXRpwY/J6doNq4EiVL8FU5QHWBUXFtfFvbDHBsAnlJW42fMLQB/KGiCxuzJ4hrIJgNTe2i/e4V4U2+29TrM59y5687DoTlfF2cJ92vysdwIwZu6mFVl1qtze1MmSgv2cDcAkt70NuRS0PXLXTWzm1eTSkP9nTiSc1hNn/cdASZZoOCNJPXle4e8d9f6GmyrlecjXYXGmarAaBflqwFlPxhP4vfaO3t31NHbePcnfkCNLYRQd+QDwfvBB0iHD4YWi3BH/j82xKqLfBGyOHoLVV9kSG/dwtgOL667gCL5ranjG8mSEB460wo/qASfMvGsvZ4OAoi17qZXSsq/eBVx/znqmOZKtz2YAAAAASUVORK5CYII="},cf9d:function(a,t){a.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAARVBMVEUAAADh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eH////h4eH6+vru7u7m5ubr6+v19fVUDuCAAAAAEHRSTlMA+PBVSIbX0buyqQsjloQkrghmVQAAAQFJREFUOMuVlVcSwyAMRIGAewFc7n/UyMxEcULz7ic8M+tFSOJPozZ9o6RUTW/0KErSg3Q3yUFn0VfrIrWvJDp1YXffTm9J/tz2sNBNiWOVI23e3uQ3R1LR4UtAbaSAL7/sfBnwNiF/mZnvrKGFw2Z00Ka5+WU2S7PvSQW2SKtPJh35tUWR7+5rwpdhz0baKLNkgm2oB/rKVkWQJnjggytHD1STkh1XXMtRaI6iGogWhl1UfRjRO3c+gU/netGw5arpRigOrhqeEvI5LCEYsgH9IBQddCnQdUOFhJQoVPzIs4IeLNIKkCazIu0LaYxIywWbOT4mWGtuAK3waMOHJjSO3yJ4XzI45cwQAAAAAElFTkSuQmCC"},e39a:function(a,t,i){"use strict";var e=function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("app-layout",[i("v-uni-view",[i("v-uni-view",{staticClass:"scan-head dir-top-nowrap main-center"},[i("v-uni-view",{staticClass:"order-name"},[a._v("订单金额")]),i("v-uni-view",{staticClass:"scan-price dir-left-nowrap cross-bottom",on:{click:function(t){t=a.$handleEvent(t),a.openPriceModel(t)}}},[i("v-uni-view",{staticClass:"order-key"},[a._v("￥")]),i("v-uni-view",{staticClass:"order-value"},[a._v(a._s(a.list.price))])],1),i("v-uni-view",{staticClass:"scan-line"}),i("v-uni-view",{staticClass:"dir-left-nowrap cross-center scan-offer"},[i("v-uni-view",{staticClass:"box-grow-1"},[a._v("订单优惠")]),i("v-uni-view",{staticClass:"box-grow-0"},[a.list.preferential_money>0?i("v-uni-view",{staticClass:"red"},[a._v("-￥"+a._s(a.list.preferential_money))]):a.list.price>0?i("v-uni-view",{staticClass:"gray"},[a._v("暂无优惠")]):a._e()],1)],1),i("v-uni-view",{staticClass:"dir-left-nowrap cross-center scan-offer"},[i("v-uni-view",{staticClass:"box-grow-1"},[a._v("优惠劵")]),i("v-uni-view",{staticClass:"box-grow-0 coupon-right"},[a.list.coupon_id?i("v-uni-view",{staticClass:"red",on:{click:function(t){t=a.$handleEvent(t),a.setCoupon(t)}}},[a._v("-￥"+a._s(a.list.coupon_preferential_money))]):a.list.price>0&&a.list.can_coupon_num>0?i("v-uni-view",{staticClass:"gray",on:{click:function(t){t=a.$handleEvent(t),a.setCoupon(t)}}},[a._v("选择优惠券")]):a.list.price>0?i("v-uni-view",{staticClass:"gray"},[a._v("暂无可用优惠券")]):a._e()],1),i("v-uni-view",{staticClass:"box-grow-0 cross-center"},[i("v-uni-icon",{staticClass:"icon-right",attrs:{type:""}})],1)],1),a.list.price>0&&a.activity&&a.integral.user_integral_num>=a.integral.member_integral&&a.list.integral_deduction>0?i("v-uni-view",{staticClass:"dir-left-nowrap cross-center scan-offer"},[i("v-uni-view",{staticClass:"box-grow-1 cross-center dir-left-nowrap"},[i("v-uni-view",[i("v-uni-text",[a._v("使用"+a._s(a.list.use_integral_num)+"积分抵扣")]),i("v-uni-text",{staticClass:"red"},[a._v(a._s(a.list.integral_deduction))]),i("v-uni-text",[a._v("元")])],1),i("v-uni-view",{staticClass:"main-center cross-center",on:{click:function(t){t=a.$handleEvent(t),a.getIntegralInfo(t)}}},[i("v-uni-icon",{staticClass:"scan-integral-icon",attrs:{type:""}})],1)],1),i("v-uni-view",{staticClass:"box-grow-0",on:{click:function(t){t=a.$handleEvent(t),a.handleUseIntegral(t)}}},[1==a.list.use_integral?i("v-uni-icon",{staticClass:"scan-integral-switch check",attrs:{type:""}}):i("v-uni-icon",{staticClass:"scan-integral-switch uncheck",attrs:{type:""}})],1)],1):a._e(),i("v-uni-view",{staticClass:"dir-left-nowrap scan-offer"},[i("v-uni-input",{staticClass:"scan-input",attrs:{value:a.remark,placeholder:"添加备注"},on:{input:function(t){t=a.$handleEvent(t),a.bindTextBlur(t)}}})],1),i("v-uni-view",{staticClass:"scan-line"}),i("v-uni-view",{staticClass:"scan-remark cross-center dir-left-nowrap main-center"},[i("v-uni-view",{staticClass:"key"},[a._v("应付金额")]),i("v-uni-view",{staticClass:"value"},[a._v("￥"+a._s(a.list.pay_price))])],1)],1),i("v-uni-view",{staticClass:"main-center cross-center scan-btn"},[i("app-button",{attrs:{color:"#ffffff","font-size":"32",height:"88",width:"702",background:a.list.price>0?"#ff4544":"#cdcdcd",disabled:a.list.price<=0,round:""},on:{click:function(t){t=a.$handleEvent(t),a.submit(t)}}},[a._v("已与店员确认，立即买单")])],1),a.activity.rules?i("v-uni-view",{staticClass:"scan-end"},[i("v-uni-view",{staticClass:"dir-left-nowrap cross-center"},[i("v-uni-view",{staticClass:"icon"}),i("v-uni-view",[a._v("规则说明")])],1),i("v-uni-text",{attrs:{space:"nbsp"}},[a._v(a._s(a.activity.rules))])],1):a._e()],1),a.price_modal?i("v-uni-view",{staticClass:"scan-modal show bt"},[i("v-uni-view",{staticClass:"scan-modal-bg"}),i("v-uni-view",{staticClass:"scan-modal-pic main-center"},[i("v-uni-view",{staticClass:"info-model cross-center dir-top-nowrap"},[i("v-uni-view",{staticClass:"order-title"},[a._v("订单金额")]),i("v-uni-view",{staticClass:"info-box dir-left-nowrap cross-center"},[i("v-uni-input",{staticClass:"info-input",attrs:{focus:"",value:a.tmp_price,type:"digit","placeholder-class":"place",placeholder:"输入支付金额"},on:{input:function(t){t=a.$handleEvent(t),a.setTempInput(t)}}}),i("v-uni-view",[a._v("元")])],1),i("v-uni-view",{staticClass:"info-end dir-left-nowrap cross-center"},[i("v-uni-view",{staticClass:"box-grow-1 main-center cross-center",on:{click:function(t){t=a.$handleEvent(t),a.closePriceModel(t)}}},[a._v("取消")]),i("v-uni-view",{staticClass:"box-grow-0 info-line"}),i("v-uni-view",{staticClass:"box-grow-1 red main-center cross-center",on:{click:function(t){t=a.$handleEvent(t),a.calcPrice(t)}}},[a._v("确认")])],1)],1)],1)],1):a._e()],1)},n=[];i.d(t,"a",function(){return e}),i.d(t,"b",function(){return n})},efb87:function(a,t,i){var e=i("9432");"string"===typeof e&&(e=[[a.i,e,""]]),e.locals&&(a.exports=e.locals);var n=i("4f06").default;n("22f7dbbb",e,!0,{sourceMap:!1,shadowMode:!1})},f48d1:function(a,t,i){"use strict";var e=i("efb87"),n=i.n(e);n.a}}]);